parameters:
- name: module
  type: string
  default: 'azure-quantum'
- name: beta
  type: string
  default: ''


steps:
- pwsh: ./bootstrap.ps1 ${{ parameters.module }}
  displayName: Create ${{ parameters.module }} conda environment
- ${{ if ne(parameters.beta, '') }}:
  - pwsh: build/build.ps1 ${{ parameters.beta }} ${{ parameters.module }} -FromSource $False -IsBeta $True
    displayName: Install ${{ parameters.beta }} package in env
- pwsh: build/build.ps1 ${{ parameters.module }} -FromSource $True
  displayName: Install ${{ parameters.module }} package in env
- pwsh: build/pack.ps1 ${{ parameters.module }}
  displayName: Pack ${{ parameters.module }}
- pwsh: build/test.ps1 ${{ parameters.module }}
  displayName: Test ${{ parameters.module }}
